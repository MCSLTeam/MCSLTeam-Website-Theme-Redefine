"use strict";const TAB_BLOCK_REGEX=/<!--\s*tab (.*?)\s*-->\n([\w\W\s\S]*?)<!--\s*endtab\s*-->/g,APLAYER_TAG_REGEX=/\<div.*class=\"aplayer aplayer-tag-marker\"(.|\n)*\<\/script\>/g,FANCYBOX_TAG_REGEX=/\<div.*galleryFlag(.|\n)*\<\/span\>\<\/div\>\<\/div\>/g;function parseArgs(e){return/::/g.test(e)?e.join(" ").split("::"):e.join(" ").split(",")}function extractMatches(e){const a=[];let t;for(;null!==(t=TAB_BLOCK_REGEX.exec(e));)a.push(t[1]),a.push(t[2]);return a}function processAplayerTag(e){let a=0;return/class="aplayer aplayer-tag-marker"/g.test(e)&&(a=APLAYER_TAG_REGEX.exec(e)[0],e=e.replace(APLAYER_TAG_REGEX,"@aplayerTag@")),{content:e,aplayerTag:a}}function processFancyboxTag(e){let a=0;return/galleryFlag/g.test(e)&&(a=FANCYBOX_TAG_REGEX.exec(e)[0],e=e.replace(FANCYBOX_TAG_REGEX,"@fancyboxTag@")),{content:e,fancyboxTag:a}}function buildTabNavAndContent(e,a,t){let s="",n="";for(let r=0;r<e.length;r+=2){const o=e[r].split("@"),c=e[r+1],l=o[0]||"",i=o[1]||"",p=(a+" "+(r/2+1)).toLowerCase().split(" ").join("-"),{content:b,aplayerTag:g}=processAplayerTag(c),{content:d,fancyboxTag:u}=processFancyboxTag(b),T=hexo.render.renderSync({text:d,engine:"markdown"}).trim().replace(/\<pre\>\<code\>.*@aplayerTag@.*\<\/code><\/pre>/,g).replace(/.*@fancyboxTag@.*/,u),A=t>0&&t===r/2+1||0===t&&0===r?" active":"";s+=`<li class="tab${A}"><a class="#${p}">${i+l.trim()}</a></li>`,n+=`<div class="tab-pane${A}" id="${p}">${T}</div>`}return{tabNav:s,tabContent:n}}function postTabs(e,a){const[t,s]=parseArgs(e),n=Number(s)||0;!t&&hexo.log.warn("Tabs block must have unique name!");const r=extractMatches(a),{tabNav:o,tabContent:c}=buildTabNavAndContent(r,t,n),l=`<ul class="nav-tabs">${o}</ul>`,i=`<div class="tab-content">${c}</div>`;return`<div class="tabs" id="tab-${t.toLowerCase().split(" ").join("-")}">${l+i}</div>`}hexo.extend.tag.register("tabs",postTabs,{ends:!0}),hexo.extend.tag.register("subtabs",postTabs,{ends:!0}),hexo.extend.tag.register("subsubtabs",postTabs,{ends:!0});